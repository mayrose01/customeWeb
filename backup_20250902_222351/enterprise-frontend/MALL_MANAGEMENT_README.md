# 商城管理功能说明

## 概述

商城管理是一个独立的企业网站模块，与企业网站原有的产品、分类、订单系统分开。它提供了完整的电商功能，包括：

- 商城分类管理
- 商城产品管理
- 产品规格和SKU管理
- 商城订单管理
- 购物车功能

## 功能特性

### 1. 商城分类管理
- 支持树形分类结构
- 分类的增删查改操作
- 分类排序和状态管理
- 分类图片上传

### 2. 商城产品管理
- 产品的增删查改操作
- 产品图片管理（最多5张）
- 产品分类关联
- 产品状态管理（上架/下架）
- 产品复制功能

### 3. 产品规格管理
- 支持多种规格类型（如颜色、尺寸、存储等）
- 规格值的动态添加和删除
- 基于规格组合的SKU管理
- 不同SKU对应不同价格和库存

### 4. 商城订单管理
- 订单列表查看和筛选
- 订单状态更新（待付款、已付款、已发货、已完成、已取消）
- 订单发货和物流信息管理
- 订单统计和报表

## 技术架构

### 后端API
- **商城分类**: `/api/mall-category/`
- **商城产品**: `/api/mall-product/`
- **商城规格**: `/api/mall-specification/`
- **商城订单**: `/api/mall-order/`

### 数据库表结构
- `mall_categories` - 商城分类表
- `mall_products` - 商城产品表
- `mall_product_specifications` - 产品规格表
- `mall_product_specification_values` - 规格值表
- `mall_product_skus` - 产品SKU表
- `mall_orders` - 商城订单表
- `mall_order_items` - 订单项表
- `mall_carts` - 购物车表
- `mall_cart_items` - 购物车项表

## 安装和配置

### 1. 创建数据库表
```bash
cd enterprise-backend
python create_mall_tables.py
```

### 2. 启动后端服务
```bash
cd enterprise-backend
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 3. 启动前端服务
```bash
cd enterprise-frontend
npm run dev
```

## 使用说明

### 分类管理
1. 在"分类管理"标签页中，点击"新增分类"按钮
2. 填写分类名称、描述、排序等信息
3. 选择父分类（可选，支持树形结构）
4. 设置分类状态（启用/禁用）

### 产品管理
1. 在"产品管理"标签页中，点击"新增产品"按钮
2. 填写产品基本信息（名称、描述、价格、库存等）
3. 选择产品分类
4. 上传产品图片
5. 设置产品状态

### 规格管理
1. 在产品编辑页面，点击"规格"按钮
2. 添加规格类型（如颜色、尺寸）
3. 为每个规格添加具体的值（如红色、XL）
4. 系统自动生成SKU组合

### 订单管理
1. 在"订单管理"标签页中查看所有订单
2. 使用筛选条件查找特定订单
3. 点击"发货"按钮更新订单状态
4. 填写物流信息（快递公司、快递单号）

## API接口说明

### 商城分类API
- `GET /api/mall-category/` - 获取分类列表
- `POST /api/mall-category/` - 创建分类
- `PUT /api/mall-category/{id}` - 更新分类
- `DELETE /api/mall-category/{id}` - 删除分类

### 商城产品API
- `GET /api/mall-product/` - 获取产品列表
- `POST /api/mall-product/` - 创建产品
- `PUT /api/mall-product/{id}` - 更新产品
- `DELETE /api/mall-product/{id}` - 删除产品

### 商城订单API
- `GET /api/mall-order/` - 获取订单列表
- `PUT /api/mall-order/{id}/status` - 更新订单状态
- `PUT /api/mall-order/{id}/shipping` - 更新物流信息

## 注意事项

1. **数据隔离**: 商城数据与企业网站原有数据完全分离
2. **权限控制**: 需要管理员权限才能访问商城管理功能
3. **图片上传**: 支持JPG、PNG等常见图片格式
4. **数据备份**: 建议定期备份商城相关数据

## 故障排除

### 常见问题
1. **API调用失败**: 检查后端服务是否正常运行
2. **图片上传失败**: 检查上传目录权限和磁盘空间
3. **数据库连接失败**: 检查数据库配置和连接信息

### 日志查看
- 后端日志: `enterprise-backend/logs/`
- 前端控制台: 浏览器开发者工具

## 扩展功能

### 计划中的功能
- 库存预警
- 销售统计报表
- 批量导入导出
- 优惠券管理
- 会员积分系统

### 自定义开发
如需添加新功能，请参考现有的代码结构，遵循相同的开发模式。

## 技术支持

如有问题，请查看：
1. 后端日志文件
2. 前端控制台错误信息
3. 数据库连接状态
4. API接口响应状态
